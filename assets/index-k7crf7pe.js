var Ki=Object.defineProperty;var nr=(n,t,e)=>t in n?Ki(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var Ft=(n,t,e)=>(nr(n,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const s of l.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function e(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(r){if(r.ep)return;r.ep=!0;const l=e(r);fetch(r.href,l)}})();function K(){}function Ci(n){return n()}function Ee(){return Object.create(null)}function _n(n){n.forEach(Ci)}function de(n){return typeof n=="function"}function Bn(n,t){return n!=n?t==t:n!==t||n&&typeof n=="object"||typeof n=="function"}function tr(n){return Object.keys(n).length===0}function Ht(n){return n??""}const er=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function P(n,t){n.appendChild(t)}function x(n,t,e){n.insertBefore(t,e||null)}function z(n){n.parentNode&&n.parentNode.removeChild(n)}function Ei(n,t){for(let e=0;e<n.length;e+=1)n[e]&&n[e].d(t)}function k(n){return document.createElement(n)}function pn(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function B(n){return document.createTextNode(n)}function j(){return B(" ")}function Rt(){return B("")}function an(n,t,e,i){return n.addEventListener(t,e,i),()=>n.removeEventListener(t,e,i)}function b(n,t,e){e==null?n.removeAttribute(t):n.getAttribute(t)!==e&&n.setAttribute(t,e)}function Ni(n){return n===""?null:+n}function ir(n){return Array.from(n.childNodes)}function en(n,t){t=""+t,n.data!==t&&(n.data=t)}function yt(n,t){n.value=t??""}let _e;function tt(n){_e=n}const bn=[],kn=[];let Ln=[];const Zt=[],rr=Promise.resolve();let Yt=!1;function lr(){Yt||(Yt=!0,rr.then(Pi))}function mt(n){Ln.push(n)}function ve(n){Zt.push(n)}const qt=new Set;let Pn=0;function Pi(){if(Pn!==0)return;const n=_e;do{try{for(;Pn<bn.length;){const t=bn[Pn];Pn++,tt(t),or(t.$$)}}catch(t){throw bn.length=0,Pn=0,t}for(tt(null),bn.length=0,Pn=0;kn.length;)kn.pop()();for(let t=0;t<Ln.length;t+=1){const e=Ln[t];qt.has(e)||(qt.add(e),e())}Ln.length=0}while(bn.length);for(;Zt.length;)Zt.pop()();Yt=!1,qt.clear(),tt(n)}function or(n){if(n.fragment!==null){n.update(),_n(n.before_update);const t=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,t),n.after_update.forEach(mt)}}function sr(n){const t=[],e=[];Ln.forEach(i=>n.indexOf(i)===-1?t.push(i):e.push(i)),e.forEach(i=>i()),Ln=t}const dt=new Set;let mn;function Ne(){mn={r:0,c:[],p:mn}}function Pe(){mn.r||_n(mn.c),mn=mn.p}function nn(n,t){n&&n.i&&(dt.delete(n),n.i(t))}function gn(n,t,e,i){if(n&&n.o){if(dt.has(n))return;dt.add(n),mn.c.push(()=>{dt.delete(n),i&&(e&&n.d(1),i())}),n.o(t)}else i&&i()}function vn(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function be(n,t){n.d(1),t.delete(n.key)}function Me(n,t,e,i,r,l,s,a,h,f,o,u){let c=n.length,p=l.length,g=c;const v={};for(;g--;)v[n[g].key]=g;const d=[],_=new Map,m=new Map,w=[];for(g=p;g--;){const E=u(r,l,g),L=e(E);let A=s.get(L);A?i&&w.push(()=>A.p(E,t)):(A=f(L,E),A.c()),_.set(L,d[g]=A),L in v&&m.set(L,Math.abs(g-v[L]))}const y=new Set,C=new Set;function O(E){nn(E,1),E.m(a,o),s.set(E.key,E),o=E.first,p--}for(;c&&p;){const E=d[p-1],L=n[c-1],A=E.key,N=L.key;E===L?(o=E.first,c--,p--):_.has(N)?!s.has(A)||y.has(A)?O(E):C.has(N)?c--:m.get(A)>m.get(N)?(C.add(A),O(E)):(y.add(N),c--):(h(L,s),c--)}for(;c--;){const E=n[c];_.has(E.key)||h(E,s)}for(;p;)O(d[p-1]);return _n(w),d}function we(n,t,e){const i=n.$$.props[t];i!==void 0&&(n.$$.bound[i]=e,e(n.$$.ctx[i]))}function et(n){n&&n.c()}function On(n,t,e){const{fragment:i,after_update:r}=n.$$;i&&i.m(t,e),mt(()=>{const l=n.$$.on_mount.map(Ci).filter(de);n.$$.on_destroy?n.$$.on_destroy.push(...l):_n(l),n.$$.on_mount=[]}),r.forEach(mt)}function $n(n,t){const e=n.$$;e.fragment!==null&&(sr(e.after_update),_n(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function ur(n,t){n.$$.dirty[0]===-1&&(bn.push(n),lr(),n.$$.dirty.fill(0)),n.$$.dirty[t/31|0]|=1<<t%31}function xn(n,t,e,i,r,l,s=null,a=[-1]){const h=_e;tt(n);const f=n.$$={fragment:null,ctx:[],props:l,update:K,not_equal:r,bound:Ee(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(h?h.$$.context:[])),callbacks:Ee(),dirty:a,skip_bound:!1,root:t.target||h.$$.root};s&&s(f.root);let o=!1;if(f.ctx=e?e(n,t.props||{},(u,c,...p)=>{const g=p.length?p[0]:c;return f.ctx&&r(f.ctx[u],f.ctx[u]=g)&&(!f.skip_bound&&f.bound[u]&&f.bound[u](g),o&&ur(n,u)),c}):[],f.update(),o=!0,_n(f.before_update),f.fragment=i?i(f.ctx):!1,t.target){if(t.hydrate){const u=ir(t.target);f.fragment&&f.fragment.l(u),u.forEach(z)}else f.fragment&&f.fragment.c();t.intro&&nn(n.$$.fragment),On(n,t.target,t.anchor),Pi()}tt(h)}class jn{constructor(){Ft(this,"$$");Ft(this,"$$set")}$destroy(){$n(this,1),this.$destroy=K}$on(t,e){if(!de(e))return K;const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(e),()=>{const r=i.indexOf(e);r!==-1&&i.splice(r,1)}}$set(t){this.$$set&&!tr(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const fr="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(fr);function ar(n){return n}function cr(n){if(n==null)return ar;var t,e,i=n.scale[0],r=n.scale[1],l=n.translate[0],s=n.translate[1];return function(a,h){h||(t=e=0);var f=2,o=a.length,u=new Array(o);for(u[0]=(t+=a[0])*i+l,u[1]=(e+=a[1])*r+s;f<o;)u[f]=a[f],++f;return u}}function hr(n,t){for(var e,i=n.length,r=i-t;r<--i;)e=n[r],n[r++]=n[i],n[i]=e}function pr(n,t){return typeof t=="string"&&(t=n.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(e){return Ae(n,e)})}:Ae(n,t)}function Ae(n,t){var e=t.id,i=t.bbox,r=t.properties==null?{}:t.properties,l=gr(n,t);return e==null&&i==null?{type:"Feature",properties:r,geometry:l}:i==null?{type:"Feature",id:e,properties:r,geometry:l}:{type:"Feature",id:e,bbox:i,properties:r,geometry:l}}function gr(n,t){var e=cr(n.transform),i=n.arcs;function r(o,u){u.length&&u.pop();for(var c=i[o<0?~o:o],p=0,g=c.length;p<g;++p)u.push(e(c[p],p));o<0&&hr(u,g)}function l(o){return e(o)}function s(o){for(var u=[],c=0,p=o.length;c<p;++c)r(o[c],u);return u.length<2&&u.push(u[0]),u}function a(o){for(var u=s(o);u.length<4;)u.push(u[0]);return u}function h(o){return o.map(a)}function f(o){var u=o.type,c;switch(u){case"GeometryCollection":return{type:u,geometries:o.geometries.map(f)};case"Point":c=l(o.coordinates);break;case"MultiPoint":c=o.coordinates.map(l);break;case"LineString":c=s(o.arcs);break;case"MultiLineString":c=o.arcs.map(s);break;case"Polygon":c=h(o.arcs);break;case"MultiPolygon":c=o.arcs.map(h);break;default:return null}return{type:u,coordinates:c}}return f(t)}let Dn=class{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const l=e[r],s=t+l,a=Math.abs(t)<Math.abs(l)?t-(s-l):l-(s-t);a&&(e[i++]=a),t=s}return e[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let e=this._n,i,r,l,s=0;if(e>0){for(s=t[--e];e>0&&(i=s,r=t[--e],s=i+r,l=r-(s-i),!l););e>0&&(l<0&&t[e-1]<0||l>0&&t[e-1]>0)&&(r=l*2,i=s+r,r==i-s&&(s=i))}return s}};var dr=Math.PI,_r=dr*2,vr=Math.abs,ye=Math.sqrt;function on(){}function St(n,t){n&&Oe.hasOwnProperty(n.type)&&Oe[n.type](n,t)}var Le={Feature:function(n,t){St(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,i=-1,r=e.length;++i<r;)St(e[i].geometry,t)}},Oe={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,i=-1,r=e.length;++i<r;)n=e[i],t.point(n[0],n[1],n[2])},LineString:function(n,t){Xt(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,i=-1,r=e.length;++i<r;)Xt(e[i],t,0)},Polygon:function(n,t){$e(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,i=-1,r=e.length;++i<r;)$e(e[i],t)},GeometryCollection:function(n,t){for(var e=n.geometries,i=-1,r=e.length;++i<r;)St(e[i],t)}};function Xt(n,t,e){var i=-1,r=n.length-e,l;for(t.lineStart();++i<r;)l=n[i],t.point(l[0],l[1],l[2]);t.lineEnd()}function $e(n,t){var e=-1,i=n.length;for(t.polygonStart();++e<i;)Xt(n[e],t,1);t.polygonEnd()}function Wn(n,t){n&&Le.hasOwnProperty(n.type)?Le[n.type](n,t):St(n,t)}const wr=n=>n;var zt=new Dn,Qt=new Dn,bi,Mi,Vt,Jt,dn={point:on,lineStart:on,lineEnd:on,polygonStart:function(){dn.lineStart=yr,dn.lineEnd=Sr},polygonEnd:function(){dn.lineStart=dn.lineEnd=dn.point=on,zt.add(vr(Qt)),Qt=new Dn},result:function(){var n=zt/2;return zt=new Dn,n}};function yr(){dn.point=mr}function mr(n,t){dn.point=Ai,bi=Vt=n,Mi=Jt=t}function Ai(n,t){Qt.add(Jt*n-Vt*t),Vt=n,Jt=t}function Sr(){Ai(bi,Mi)}var Tn=1/0,Ct=Tn,it=-Tn,Et=it,ke={point:Cr,lineStart:on,lineEnd:on,polygonStart:on,polygonEnd:on,result:function(){var n=[[Tn,Ct],[it,Et]];return it=Et=-(Ct=Tn=1/0),n}};function Cr(n,t){n<Tn&&(Tn=n),n>it&&(it=n),t<Ct&&(Ct=t),t>Et&&(Et=t)}var Kt=0,ne=0,Zn=0,Nt=0,Pt=0,Mn=0,te=0,ee=0,Yn=0,Li,Oi,un,fn,tn={point:Sn,lineStart:De,lineEnd:Te,polygonStart:function(){tn.lineStart=Pr,tn.lineEnd=br},polygonEnd:function(){tn.point=Sn,tn.lineStart=De,tn.lineEnd=Te},result:function(){var n=Yn?[te/Yn,ee/Yn]:Mn?[Nt/Mn,Pt/Mn]:Zn?[Kt/Zn,ne/Zn]:[NaN,NaN];return Kt=ne=Zn=Nt=Pt=Mn=te=ee=Yn=0,n}};function Sn(n,t){Kt+=n,ne+=t,++Zn}function De(){tn.point=Er}function Er(n,t){tn.point=Nr,Sn(un=n,fn=t)}function Nr(n,t){var e=n-un,i=t-fn,r=ye(e*e+i*i);Nt+=r*(un+n)/2,Pt+=r*(fn+t)/2,Mn+=r,Sn(un=n,fn=t)}function Te(){tn.point=Sn}function Pr(){tn.point=Mr}function br(){$i(Li,Oi)}function Mr(n,t){tn.point=$i,Sn(Li=un=n,Oi=fn=t)}function $i(n,t){var e=n-un,i=t-fn,r=ye(e*e+i*i);Nt+=r*(un+n)/2,Pt+=r*(fn+t)/2,Mn+=r,r=fn*n-un*t,te+=r*(un+n),ee+=r*(fn+t),Yn+=r*3,Sn(un=n,fn=t)}function ki(n){this._context=n}ki.prototype={_radius:4.5,pointRadius:function(n){return this._radius=n,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(n,t){switch(this._point){case 0:{this._context.moveTo(n,t),this._point=1;break}case 1:{this._context.lineTo(n,t);break}default:{this._context.moveTo(n+this._radius,t),this._context.arc(n,t,this._radius,0,_r);break}}},result:on};var ie=new Dn,Gt,Di,Ti,Xn,Qn,rt={point:on,lineStart:function(){rt.point=Ar},lineEnd:function(){Gt&&Ri(Di,Ti),rt.point=on},polygonStart:function(){Gt=!0},polygonEnd:function(){Gt=null},result:function(){var n=+ie;return ie=new Dn,n}};function Ar(n,t){rt.point=Ri,Di=Xn=n,Ti=Qn=t}function Ri(n,t){Xn-=n,Qn-=t,ie.add(ye(Xn*Xn+Qn*Qn)),Xn=n,Qn=t}let Re,bt,Ie,Fe;class qe{constructor(t){this._append=t==null?Ii:Lr(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,e){switch(this._point){case 0:{this._append`M${t},${e}`,this._point=1;break}case 1:{this._append`L${t},${e}`;break}default:{if(this._append`M${t},${e}`,this._radius!==Ie||this._append!==bt){const i=this._radius,r=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,Ie=i,bt=this._append,Fe=this._,this._=r}this._+=Fe;break}}}result(){const t=this._;return this._="",t.length?t:null}}function Ii(n){let t=1;this._+=n[0];for(const e=n.length;t<e;++t)this._+=arguments[t]+n[t]}function Lr(n){const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);if(t>15)return Ii;if(t!==Re){const e=10**t;Re=t,bt=function(r){let l=1;this._+=r[0];for(const s=r.length;l<s;++l)this._+=Math.round(arguments[l]*e)/e+r[l]}}return bt}function Or(n,t){let e=3,i=4.5,r,l;function s(a){return a&&(typeof i=="function"&&l.pointRadius(+i.apply(this,arguments)),Wn(a,r(l))),l.result()}return s.area=function(a){return Wn(a,r(dn)),dn.result()},s.measure=function(a){return Wn(a,r(rt)),rt.result()},s.bounds=function(a){return Wn(a,r(ke)),ke.result()},s.centroid=function(a){return Wn(a,r(tn)),tn.result()},s.projection=function(a){return arguments.length?(r=a==null?(n=null,wr):(n=a).stream,s):n},s.context=function(a){return arguments.length?(l=a==null?(t=null,new qe(e)):new ki(t=a),typeof i!="function"&&l.pointRadius(i),s):t},s.pointRadius=function(a){return arguments.length?(i=typeof a=="function"?a:(l.pointRadius(+a),+a),s):i},s.digits=function(a){if(!arguments.length)return e;if(a==null)e=null;else{const h=Math.floor(a);if(!(h>=0))throw new RangeError(`invalid digits: ${a}`);e=h}return t===null&&(l=new qe(e)),s},s.projection(n).digits(e).context(t)}var ft=1e-6;class $r{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const l=e[r],s=t+l,a=Math.abs(t)<Math.abs(l)?t-(s-l):l-(s-t);a&&(e[i++]=a),t=s}return e[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let e=this._n,i,r,l,s=0;if(e>0){for(s=t[--e];e>0&&(i=s,r=t[--e],s=i+r,l=r-(s-i),!l););e>0&&(l<0&&t[e-1]<0||l>0&&t[e-1]>0)&&(r=l*2,i=s+r,r==i-s&&(s=i))}return s}}function*kr(n){for(const t of n)yield*t}function Fi(n){return Array.from(kr(n))}var q=1e-6,Dr=1e-12,R=Math.PI,rn=R/2,ze=R/4,sn=R*2,ln=180/R,X=R/180,U=Math.abs,Tr=Math.atan,Rn=Math.atan2,W=Math.cos,G=Math.sin,_t=Math.sign||function(n){return n>0?1:n<0?-1:0},In=Math.sqrt;function Rr(n){return n>1?0:n<-1?R:Math.acos(n)}function Cn(n){return n>1?rn:n<-1?-rn:Math.asin(n)}function Vn(){}function Mt(n,t){n&&Be.hasOwnProperty(n.type)&&Be[n.type](n,t)}var Ge={Feature:function(n,t){Mt(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,i=-1,r=e.length;++i<r;)Mt(e[i].geometry,t)}},Be={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,i=-1,r=e.length;++i<r;)n=e[i],t.point(n[0],n[1],n[2])},LineString:function(n,t){re(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,i=-1,r=e.length;++i<r;)re(e[i],t,0)},Polygon:function(n,t){xe(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,i=-1,r=e.length;++i<r;)xe(e[i],t)},GeometryCollection:function(n,t){for(var e=n.geometries,i=-1,r=e.length;++i<r;)Mt(e[i],t)}};function re(n,t,e){var i=-1,r=n.length-e,l;for(t.lineStart();++i<r;)l=n[i],t.point(l[0],l[1],l[2]);t.lineEnd()}function xe(n,t){var e=-1,i=n.length;for(t.polygonStart();++e<i;)re(n[e],t,1);t.polygonEnd()}function qi(n,t){n&&Ge.hasOwnProperty(n.type)?Ge[n.type](n,t):Mt(n,t)}function le(n){return[Rn(n[1],n[0]),Cn(n[2])]}function Fn(n){var t=n[0],e=n[1],i=W(e);return[i*W(t),i*G(t),G(e)]}function at(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function At(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function Bt(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function ct(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function oe(n){var t=In(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function se(n,t){function e(i,r){return i=n(i,r),t(i[0],i[1])}return n.invert&&t.invert&&(e.invert=function(i,r){return i=t.invert(i,r),i&&n.invert(i[0],i[1])}),e}function ue(n,t){return[U(n)>R?n+Math.round(-n/sn)*sn:n,t]}ue.invert=ue;function Ir(n,t,e){return(n%=sn)?t||e?se(We(n),Ue(t,e)):We(n):t||e?Ue(t,e):ue}function je(n){return function(t,e){return t+=n,[t>R?t-sn:t<-R?t+sn:t,e]}}function We(n){var t=je(n);return t.invert=je(-n),t}function Ue(n,t){var e=W(n),i=G(n),r=W(t),l=G(t);function s(a,h){var f=W(h),o=W(a)*f,u=G(a)*f,c=G(h),p=c*e+o*i;return[Rn(u*r-p*l,o*e-c*i),Cn(p*r+u*l)]}return s.invert=function(a,h){var f=W(h),o=W(a)*f,u=G(a)*f,c=G(h),p=c*r-u*l;return[Rn(u*r+c*l,o*e+p*i),Cn(p*e-o*i)]},s}function Fr(n,t,e,i,r,l){if(e){var s=W(t),a=G(t),h=i*e;r==null?(r=t+i*sn,l=t-h/2):(r=He(s,r),l=He(s,l),(i>0?r<l:r>l)&&(r+=i*sn));for(var f,o=r;i>0?o>l:o<l;o-=h)f=le([s,-a*W(o),-a*G(o)]),n.point(f[0],f[1])}}function He(n,t){t=Fn(t),t[0]-=n,oe(t);var e=Rr(-t[1]);return((-t[2]<0?-e:e)+sn-q)%sn}function zi(){var n=[],t;return{point:function(e,i,r){t.push([e,i,r])},lineStart:function(){n.push(t=[])},lineEnd:Vn,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var e=n;return n=[],t=null,e}}}function vt(n,t){return U(n[0]-t[0])<q&&U(n[1]-t[1])<q}function ht(n,t,e,i){this.x=n,this.z=t,this.o=e,this.e=i,this.v=!1,this.n=this.p=null}function Gi(n,t,e,i,r){var l=[],s=[],a,h;if(n.forEach(function(g){if(!((v=g.length-1)<=0)){var v,d=g[0],_=g[v],m;if(vt(d,_)){if(!d[2]&&!_[2]){for(r.lineStart(),a=0;a<v;++a)r.point((d=g[a])[0],d[1]);r.lineEnd();return}_[0]+=2*q}l.push(m=new ht(d,g,null,!0)),s.push(m.o=new ht(d,null,m,!1)),l.push(m=new ht(_,g,null,!1)),s.push(m.o=new ht(_,null,m,!0))}}),!!l.length){for(s.sort(t),Ze(l),Ze(s),a=0,h=s.length;a<h;++a)s[a].e=e=!e;for(var f=l[0],o,u;;){for(var c=f,p=!0;c.v;)if((c=c.n)===f)return;o=c.z,r.lineStart();do{if(c.v=c.o.v=!0,c.e){if(p)for(a=0,h=o.length;a<h;++a)r.point((u=o[a])[0],u[1]);else i(c.x,c.n.x,1,r);c=c.n}else{if(p)for(o=c.p.z,a=o.length-1;a>=0;--a)r.point((u=o[a])[0],u[1]);else i(c.x,c.p.x,-1,r);c=c.p}c=c.o,o=c.z,p=!p}while(!c.v);r.lineEnd()}}}function Ze(n){if(t=n.length){for(var t,e=0,i=n[0],r;++e<t;)i.n=r=n[e],r.p=i,i=r;i.n=r=n[0],r.p=i}}function xt(n){return U(n[0])<=R?n[0]:_t(n[0])*((U(n[0])+R)%sn-R)}function qr(n,t){var e=xt(t),i=t[1],r=G(i),l=[G(e),-W(e),0],s=0,a=0,h=new $r;r===1?i=rn+q:r===-1&&(i=-rn-q);for(var f=0,o=n.length;f<o;++f)if(c=(u=n[f]).length)for(var u,c,p=u[c-1],g=xt(p),v=p[1]/2+ze,d=G(v),_=W(v),m=0;m<c;++m,g=y,d=O,_=E,p=w){var w=u[m],y=xt(w),C=w[1]/2+ze,O=G(C),E=W(C),L=y-g,A=L>=0?1:-1,N=A*L,M=N>R,D=d*O;if(h.add(Rn(D*A*G(N),_*E+D*W(N))),s+=M?L+A*sn:L,M^g>=e^y>=e){var T=At(Fn(p),Fn(w));oe(T);var I=At(l,T);oe(I);var S=(M^L>=0?-1:1)*Cn(I[2]);(i>S||i===S&&(T[0]||T[1]))&&(a+=M^L>=0?1:-1)}}return(s<-q||s<q&&h<-Dr)^a&1}function Bi(n,t,e,i){return function(r){var l=t(r),s=zi(),a=t(s),h=!1,f,o,u,c={point:p,lineStart:v,lineEnd:d,polygonStart:function(){c.point=_,c.lineStart=m,c.lineEnd=w,o=[],f=[]},polygonEnd:function(){c.point=p,c.lineStart=v,c.lineEnd=d,o=Fi(o);var y=qr(f,i);o.length?(h||(r.polygonStart(),h=!0),Gi(o,Gr,y,e,r)):y&&(h||(r.polygonStart(),h=!0),r.lineStart(),e(null,null,1,r),r.lineEnd()),h&&(r.polygonEnd(),h=!1),o=f=null},sphere:function(){r.polygonStart(),r.lineStart(),e(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function p(y,C){n(y,C)&&r.point(y,C)}function g(y,C){l.point(y,C)}function v(){c.point=g,l.lineStart()}function d(){c.point=p,l.lineEnd()}function _(y,C){u.push([y,C]),a.point(y,C)}function m(){a.lineStart(),u=[]}function w(){_(u[0][0],u[0][1]),a.lineEnd();var y=a.clean(),C=s.result(),O,E=C.length,L,A,N;if(u.pop(),f.push(u),u=null,!!E){if(y&1){if(A=C[0],(L=A.length-1)>0){for(h||(r.polygonStart(),h=!0),r.lineStart(),O=0;O<L;++O)r.point((N=A[O])[0],N[1]);r.lineEnd()}return}E>1&&y&2&&C.push(C.pop().concat(C.shift())),o.push(C.filter(zr))}}return c}}function zr(n){return n.length>1}function Gr(n,t){return((n=n.x)[0]<0?n[1]-rn-q:rn-n[1])-((t=t.x)[0]<0?t[1]-rn-q:rn-t[1])}const Ye=Bi(function(){return!0},Br,jr,[-R,-rn]);function Br(n){var t=NaN,e=NaN,i=NaN,r;return{lineStart:function(){n.lineStart(),r=1},point:function(l,s){var a=l>0?R:-R,h=U(l-t);U(h-R)<q?(n.point(t,e=(e+s)/2>0?rn:-rn),n.point(i,e),n.lineEnd(),n.lineStart(),n.point(a,e),n.point(l,e),r=0):i!==a&&h>=R&&(U(t-i)<q&&(t-=i*q),U(l-a)<q&&(l-=a*q),e=xr(t,e,l,s),n.point(i,e),n.lineEnd(),n.lineStart(),n.point(a,e),r=0),n.point(t=l,e=s),i=a},lineEnd:function(){n.lineEnd(),t=e=NaN},clean:function(){return 2-r}}}function xr(n,t,e,i){var r,l,s=G(n-e);return U(s)>q?Tr((G(t)*(l=W(i))*G(e)-G(i)*(r=W(t))*G(n))/(r*l*s)):(t+i)/2}function jr(n,t,e,i){var r;if(n==null)r=e*rn,i.point(-R,r),i.point(0,r),i.point(R,r),i.point(R,0),i.point(R,-r),i.point(0,-r),i.point(-R,-r),i.point(-R,0),i.point(-R,r);else if(U(n[0]-t[0])>q){var l=n[0]<t[0]?R:-R;r=e*l/2,i.point(-l,r),i.point(0,r),i.point(l,r)}else i.point(t[0],t[1])}function Wr(n){var t=W(n),e=6*X,i=t>0,r=U(t)>q;function l(o,u,c,p){Fr(p,n,e,c,o,u)}function s(o,u){return W(o)*W(u)>t}function a(o){var u,c,p,g,v;return{lineStart:function(){g=p=!1,v=1},point:function(d,_){var m=[d,_],w,y=s(d,_),C=i?y?0:f(d,_):y?f(d+(d<0?R:-R),_):0;if(!u&&(g=p=y)&&o.lineStart(),y!==p&&(w=h(u,m),(!w||vt(u,w)||vt(m,w))&&(m[2]=1)),y!==p)v=0,y?(o.lineStart(),w=h(m,u),o.point(w[0],w[1])):(w=h(u,m),o.point(w[0],w[1],2),o.lineEnd()),u=w;else if(r&&u&&i^y){var O;!(C&c)&&(O=h(m,u,!0))&&(v=0,i?(o.lineStart(),o.point(O[0][0],O[0][1]),o.point(O[1][0],O[1][1]),o.lineEnd()):(o.point(O[1][0],O[1][1]),o.lineEnd(),o.lineStart(),o.point(O[0][0],O[0][1],3)))}y&&(!u||!vt(u,m))&&o.point(m[0],m[1]),u=m,p=y,c=C},lineEnd:function(){p&&o.lineEnd(),u=null},clean:function(){return v|(g&&p)<<1}}}function h(o,u,c){var p=Fn(o),g=Fn(u),v=[1,0,0],d=At(p,g),_=at(d,d),m=d[0],w=_-m*m;if(!w)return!c&&o;var y=t*_/w,C=-t*m/w,O=At(v,d),E=ct(v,y),L=ct(d,C);Bt(E,L);var A=O,N=at(E,A),M=at(A,A),D=N*N-M*(at(E,E)-1);if(!(D<0)){var T=In(D),I=ct(A,(-N-T)/M);if(Bt(I,E),I=le(I),!c)return I;var S=o[0],$=u[0],H=o[1],Z=u[1],F;$<S&&(F=S,S=$,$=F);var Y=$-S,cn=U(Y-R)<q,wn=cn||Y<q;if(!cn&&Z<H&&(F=H,H=Z,Z=F),wn?cn?H+Z>0^I[1]<(U(I[0]-S)<q?H:Z):H<=I[1]&&I[1]<=Z:Y>R^(S<=I[0]&&I[0]<=$)){var hn=ct(A,(-N+T)/M);return Bt(hn,E),[I,le(hn)]}}}function f(o,u){var c=i?n:R-n,p=0;return o<-c?p|=1:o>c&&(p|=2),u<-c?p|=4:u>c&&(p|=8),p}return Bi(s,a,l,i?[0,-n]:[-R,n-R])}function Ur(n,t,e,i,r,l){var s=n[0],a=n[1],h=t[0],f=t[1],o=0,u=1,c=h-s,p=f-a,g;if(g=e-s,!(!c&&g>0)){if(g/=c,c<0){if(g<o)return;g<u&&(u=g)}else if(c>0){if(g>u)return;g>o&&(o=g)}if(g=r-s,!(!c&&g<0)){if(g/=c,c<0){if(g>u)return;g>o&&(o=g)}else if(c>0){if(g<o)return;g<u&&(u=g)}if(g=i-a,!(!p&&g>0)){if(g/=p,p<0){if(g<o)return;g<u&&(u=g)}else if(p>0){if(g>u)return;g>o&&(o=g)}if(g=l-a,!(!p&&g<0)){if(g/=p,p<0){if(g>u)return;g>o&&(o=g)}else if(p>0){if(g<o)return;g<u&&(u=g)}return o>0&&(n[0]=s+o*c,n[1]=a+o*p),u<1&&(t[0]=s+u*c,t[1]=a+u*p),!0}}}}}var Jn=1e9,pt=-Jn;function Hr(n,t,e,i){function r(f,o){return n<=f&&f<=e&&t<=o&&o<=i}function l(f,o,u,c){var p=0,g=0;if(f==null||(p=s(f,u))!==(g=s(o,u))||h(f,o)<0^u>0)do c.point(p===0||p===3?n:e,p>1?i:t);while((p=(p+u+4)%4)!==g);else c.point(o[0],o[1])}function s(f,o){return U(f[0]-n)<q?o>0?0:3:U(f[0]-e)<q?o>0?2:1:U(f[1]-t)<q?o>0?1:0:o>0?3:2}function a(f,o){return h(f.x,o.x)}function h(f,o){var u=s(f,1),c=s(o,1);return u!==c?u-c:u===0?o[1]-f[1]:u===1?f[0]-o[0]:u===2?f[1]-o[1]:o[0]-f[0]}return function(f){var o=f,u=zi(),c,p,g,v,d,_,m,w,y,C,O,E={point:L,lineStart:D,lineEnd:T,polygonStart:N,polygonEnd:M};function L(S,$){r(S,$)&&o.point(S,$)}function A(){for(var S=0,$=0,H=p.length;$<H;++$)for(var Z=p[$],F=1,Y=Z.length,cn=Z[0],wn,hn,ut=cn[0],Nn=cn[1];F<Y;++F)wn=ut,hn=Nn,cn=Z[F],ut=cn[0],Nn=cn[1],hn<=i?Nn>i&&(ut-wn)*(i-hn)>(Nn-hn)*(n-wn)&&++S:Nn<=i&&(ut-wn)*(i-hn)<(Nn-hn)*(n-wn)&&--S;return S}function N(){o=u,c=[],p=[],O=!0}function M(){var S=A(),$=O&&S,H=(c=Fi(c)).length;($||H)&&(f.polygonStart(),$&&(f.lineStart(),l(null,null,1,f),f.lineEnd()),H&&Gi(c,a,S,l,f),f.polygonEnd()),o=f,c=p=g=null}function D(){E.point=I,p&&p.push(g=[]),C=!0,y=!1,m=w=NaN}function T(){c&&(I(v,d),_&&y&&u.rejoin(),c.push(u.result())),E.point=L,y&&o.lineEnd()}function I(S,$){var H=r(S,$);if(p&&g.push([S,$]),C)v=S,d=$,_=H,C=!1,H&&(o.lineStart(),o.point(S,$));else if(H&&y)o.point(S,$);else{var Z=[m=Math.max(pt,Math.min(Jn,m)),w=Math.max(pt,Math.min(Jn,w))],F=[S=Math.max(pt,Math.min(Jn,S)),$=Math.max(pt,Math.min(Jn,$))];Ur(Z,F,n,t,e,i)?(y||(o.lineStart(),o.point(Z[0],Z[1])),o.point(F[0],F[1]),H||o.lineEnd(),O=!1):H&&(o.lineStart(),o.point(S,$),O=!1)}m=S,w=$,y=H}return E}}const Xe=n=>n;var qn=1/0,Lt=qn,lt=-qn,Ot=lt,Zr={point:Yr,lineStart:Vn,lineEnd:Vn,polygonStart:Vn,polygonEnd:Vn,result:function(){var n=[[qn,Lt],[lt,Ot]];return lt=Ot=-(Lt=qn=1/0),n}};function Yr(n,t){n<qn&&(qn=n),n>lt&&(lt=n),t<Lt&&(Lt=t),t>Ot&&(Ot=t)}const Qe=Zr;function me(n){return function(t){var e=new fe;for(var i in n)e[i]=n[i];return e.stream=t,e}}function fe(){}fe.prototype={constructor:fe,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Se(n,t,e){var i=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),i!=null&&n.clipExtent(null),qi(e,n.stream(Qe)),t(Qe.result()),i!=null&&n.clipExtent(i),n}function xi(n,t,e){return Se(n,function(i){var r=t[1][0]-t[0][0],l=t[1][1]-t[0][1],s=Math.min(r/(i[1][0]-i[0][0]),l/(i[1][1]-i[0][1])),a=+t[0][0]+(r-s*(i[1][0]+i[0][0]))/2,h=+t[0][1]+(l-s*(i[1][1]+i[0][1]))/2;n.scale(150*s).translate([a,h])},e)}function Xr(n,t,e){return xi(n,[[0,0],t],e)}function Qr(n,t,e){return Se(n,function(i){var r=+t,l=r/(i[1][0]-i[0][0]),s=(r-l*(i[1][0]+i[0][0]))/2,a=-l*i[0][1];n.scale(150*l).translate([s,a])},e)}function Vr(n,t,e){return Se(n,function(i){var r=+t,l=r/(i[1][1]-i[0][1]),s=-l*i[0][0],a=(r-l*(i[1][1]+i[0][1]))/2;n.scale(150*l).translate([s,a])},e)}var Ve=16,Jr=W(30*X);function Je(n,t){return+t?nl(n,t):Kr(n)}function Kr(n){return me({point:function(t,e){t=n(t,e),this.stream.point(t[0],t[1])}})}function nl(n,t){function e(i,r,l,s,a,h,f,o,u,c,p,g,v,d){var _=f-i,m=o-r,w=_*_+m*m;if(w>4*t&&v--){var y=s+c,C=a+p,O=h+g,E=In(y*y+C*C+O*O),L=Cn(O/=E),A=U(U(O)-1)<q||U(l-u)<q?(l+u)/2:Rn(C,y),N=n(A,L),M=N[0],D=N[1],T=M-i,I=D-r,S=m*T-_*I;(S*S/w>t||U((_*T+m*I)/w-.5)>.3||s*c+a*p+h*g<Jr)&&(e(i,r,l,s,a,h,M,D,A,y/=E,C/=E,O,v,d),d.point(M,D),e(M,D,A,y,C,O,f,o,u,c,p,g,v,d))}}return function(i){var r,l,s,a,h,f,o,u,c,p,g,v,d={point:_,lineStart:m,lineEnd:y,polygonStart:function(){i.polygonStart(),d.lineStart=C},polygonEnd:function(){i.polygonEnd(),d.lineStart=m}};function _(L,A){L=n(L,A),i.point(L[0],L[1])}function m(){u=NaN,d.point=w,i.lineStart()}function w(L,A){var N=Fn([L,A]),M=n(L,A);e(u,c,o,p,g,v,u=M[0],c=M[1],o=L,p=N[0],g=N[1],v=N[2],Ve,i),i.point(u,c)}function y(){d.point=_,i.lineEnd()}function C(){m(),d.point=O,d.lineEnd=E}function O(L,A){w(r=L,A),l=u,s=c,a=p,h=g,f=v,d.point=w}function E(){e(u,c,o,p,g,v,l,s,r,a,h,f,Ve,i),d.lineEnd=y,y()}return d}}var tl=me({point:function(n,t){this.stream.point(n*X,t*X)}});function el(n){return me({point:function(t,e){var i=n(t,e);return this.stream.point(i[0],i[1])}})}function il(n,t,e,i,r){function l(s,a){return s*=i,a*=r,[t+n*s,e-n*a]}return l.invert=function(s,a){return[(s-t)/n*i,(e-a)/n*r]},l}function Ke(n,t,e,i,r,l){if(!l)return il(n,t,e,i,r);var s=W(l),a=G(l),h=s*n,f=a*n,o=s/n,u=a/n,c=(a*e-s*t)/n,p=(a*t+s*e)/n;function g(v,d){return v*=i,d*=r,[h*v-f*d+t,e-f*v-h*d]}return g.invert=function(v,d){return[i*(o*v-u*d+c),r*(p-u*v-o*d)]},g}function rl(n){var t,e=150,i=480,r=250,l=0,s=0,a=0,h=0,f=0,o,u=0,c=1,p=1,g=null,v=Ye,d=null,_,m,w,y=Xe,C=.5,O,E,L,A,N;function M(S){return L(S[0]*X,S[1]*X)}function D(S){return S=L.invert(S[0],S[1]),S&&[S[0]*ln,S[1]*ln]}M.stream=function(S){return A&&N===S?A:A=tl(el(o)(v(O(y(N=S)))))},M.preclip=function(S){return arguments.length?(v=S,g=void 0,I()):v},M.postclip=function(S){return arguments.length?(y=S,d=_=m=w=null,I()):y},M.clipAngle=function(S){return arguments.length?(v=+S?Wr(g=S*X):(g=null,Ye),I()):g*ln},M.clipExtent=function(S){return arguments.length?(y=S==null?(d=_=m=w=null,Xe):Hr(d=+S[0][0],_=+S[0][1],m=+S[1][0],w=+S[1][1]),I()):d==null?null:[[d,_],[m,w]]},M.scale=function(S){return arguments.length?(e=+S,T()):e},M.translate=function(S){return arguments.length?(i=+S[0],r=+S[1],T()):[i,r]},M.center=function(S){return arguments.length?(l=S[0]%360*X,s=S[1]%360*X,T()):[l*ln,s*ln]},M.rotate=function(S){return arguments.length?(a=S[0]%360*X,h=S[1]%360*X,f=S.length>2?S[2]%360*X:0,T()):[a*ln,h*ln,f*ln]},M.angle=function(S){return arguments.length?(u=S%360*X,T()):u*ln},M.reflectX=function(S){return arguments.length?(c=S?-1:1,T()):c<0},M.reflectY=function(S){return arguments.length?(p=S?-1:1,T()):p<0},M.precision=function(S){return arguments.length?(O=Je(E,C=S*S),I()):In(C)},M.fitExtent=function(S,$){return xi(M,S,$)},M.fitSize=function(S,$){return Xr(M,S,$)},M.fitWidth=function(S,$){return Qr(M,S,$)},M.fitHeight=function(S,$){return Vr(M,S,$)};function T(){var S=Ke(e,0,0,c,p,u).apply(null,t(l,s)),$=Ke(e,i-S[0],r-S[1],c,p,u);return o=Ir(a,h,f),E=se(t,$),L=se(o,E),O=Je(E,C),I()}function I(){return A=N=null,M}return function(){return t=n.apply(this,arguments),M.invert=t.invert&&D,T()}}function ll(n){var t=0,e=R/3,i=rl(n),r=i(t,e);return r.parallels=function(l){return arguments.length?i(t=l[0]*X,e=l[1]*X):[t*ln,e*ln]},r}function ol(n){var t=W(n);function e(i,r){return[i*t,G(r)/t]}return e.invert=function(i,r){return[i/t,Cn(r*t)]},e}function sl(n,t){var e=G(n),i=(e+G(t))/2;if(U(i)<q)return ol(n);var r=1+e*(2*i-e),l=In(r)/i;function s(a,h){var f=In(r-2*i*G(h))/i;return[f*G(a*=i),l-f*W(a)]}return s.invert=function(a,h){var f=l-h,o=Rn(a,U(f))*_t(f);return f*i<0&&(o-=R*_t(a)*_t(f)),[o/i,Cn((r-(a*a+f*f)*i*i)/(2*i))]},s}function ul(){return ll(sl).scale(155.424).center([0,33.6442])}function ni(){return ul().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function gt(){}var zn=1/0,$t=zn,ot=-zn,kt=ot,ti={point:fl,lineStart:gt,lineEnd:gt,polygonStart:gt,polygonEnd:gt,result:function(){var n=[[zn,$t],[ot,kt]];return ot=kt=-($t=zn=1/0),n}};function fl(n,t){n<zn&&(zn=n),n>ot&&(ot=n),t<$t&&($t=t),t>kt&&(kt=t)}function ji(n,t,e){var i=t[1][0]-t[0][0],r=t[1][1]-t[0][1],l=n.clipExtent&&n.clipExtent();n.scale(150).translate([0,0]),l!=null&&n.clipExtent(null),qi(e,n.stream(ti));var s=ti.result(),a=Math.min(i/(s[1][0]-s[0][0]),r/(s[1][1]-s[0][1])),h=+t[0][0]+(i-a*(s[1][0]+s[0][0]))/2,f=+t[0][1]+(r-a*(s[1][1]+s[0][1]))/2;return l!=null&&n.clipExtent(l),n.scale(a*150).translate([h,f])}function al(n,t,e){return ji(n,[[0,0],t],e)}const ae=Math.PI,ce=2*ae,yn=1e-6,cl=ce-yn;function he(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Wi(){return new he}he.prototype=Wi.prototype={constructor:he,moveTo:function(n,t){this._+="M"+(this._x0=this._x1=+n)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(n,t){this._+="L"+(this._x1=+n)+","+(this._y1=+t)},quadraticCurveTo:function(n,t,e,i){this._+="Q"+ +n+","+ +t+","+(this._x1=+e)+","+(this._y1=+i)},bezierCurveTo:function(n,t,e,i,r,l){this._+="C"+ +n+","+ +t+","+ +e+","+ +i+","+(this._x1=+r)+","+(this._y1=+l)},arcTo:function(n,t,e,i,r){n=+n,t=+t,e=+e,i=+i,r=+r;var l=this._x1,s=this._y1,a=e-n,h=i-t,f=l-n,o=s-t,u=f*f+o*o;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null)this._+="M"+(this._x1=n)+","+(this._y1=t);else if(u>yn)if(!(Math.abs(o*a-h*f)>yn)||!r)this._+="L"+(this._x1=n)+","+(this._y1=t);else{var c=e-l,p=i-s,g=a*a+h*h,v=c*c+p*p,d=Math.sqrt(g),_=Math.sqrt(u),m=r*Math.tan((ae-Math.acos((g+u-v)/(2*d*_)))/2),w=m/_,y=m/d;Math.abs(w-1)>yn&&(this._+="L"+(n+w*f)+","+(t+w*o)),this._+="A"+r+","+r+",0,0,"+ +(o*c>f*p)+","+(this._x1=n+y*a)+","+(this._y1=t+y*h)}},arc:function(n,t,e,i,r,l){n=+n,t=+t,e=+e,l=!!l;var s=e*Math.cos(i),a=e*Math.sin(i),h=n+s,f=t+a,o=1^l,u=l?i-r:r-i;if(e<0)throw new Error("negative radius: "+e);this._x1===null?this._+="M"+h+","+f:(Math.abs(this._x1-h)>yn||Math.abs(this._y1-f)>yn)&&(this._+="L"+h+","+f),e&&(u<0&&(u=u%ce+ce),u>cl?this._+="A"+e+","+e+",0,1,"+o+","+(n-s)+","+(t-a)+"A"+e+","+e+",0,1,"+o+","+(this._x1=h)+","+(this._y1=f):u>yn&&(this._+="A"+e+","+e+",0,"+ +(u>=ae)+","+o+","+(this._x1=n+e*Math.cos(r))+","+(this._y1=t+e*Math.sin(r))))},rect:function(n,t,e,i){this._+="M"+(this._x0=this._x1=+n)+","+(this._y0=this._y1=+t)+"h"+ +e+"v"+ +i+"h"+-e+"Z"},toString:function(){return this._}};function hl(n){var t=n.length;return{point:function(e,i){for(var r=-1;++r<t;)n[r].point(e,i)},sphere:function(){for(var e=-1;++e<t;)n[e].sphere()},lineStart:function(){for(var e=-1;++e<t;)n[e].lineStart()},lineEnd:function(){for(var e=-1;++e<t;)n[e].lineEnd()},polygonStart:function(){for(var e=-1;++e<t;)n[e].polygonStart()},polygonEnd:function(){for(var e=-1;++e<t;)n[e].polygonEnd()}}}function pl(){var n,t,e=ni().rotate([4.4,.8]).center([0,55.4]).parallels([50,60]),i,r=ni().rotate([4.4,.8]).center([0,55.4]).parallels([50,60]),l,s,a={point:function(o,u){s=[o,u]}};function h(o){var u=o[0],c=o[1];return s=null,i.point(u,c),s||(l.point(u,c),s)}h.invert=function(o){var u=e.scale(),c=e.translate(),p=(o[0]-c[0])/u,g=(o[1]-c[1])/u;return(g>=-.089&&g<.06&&p>=.029&&p<.046?r:e).invert(o)},h.stream=function(o){return n&&t===o?n:n=hl([e.stream(t=o),r.stream(o)])},h.precision=function(o){return arguments.length?(e.precision(o),r.precision(o),f()):e.precision()},h.scale=function(o){return arguments.length?(e.scale(o),r.scale(o),h.translate(e.translate())):e.scale()},h.translate=function(o){if(!arguments.length)return e.translate();var u=e.scale(),c=+o[0],p=+o[1];return i=e.translate(o).clipExtent([[c-.065*u,p-.089*u],[c+.075*u,p+.089*u]]).stream(a),l=r.translate([c+.01*u,p+.025*u]).clipExtent([[c+.029*u+ft,p-.089*u+ft],[c+.046*u-ft,p-.06*u-ft]]).stream(a),f()},h.fitExtent=function(o,u){return ji(h,o,u)},h.fitSize=function(o,u){return al(h,o,u)};function f(){return n=t=null,h}return h.drawCompositionBorders=function(o){var u,c,p,g;u=e([-1.113205870242365,59.64920050773357]),c=e([.807899092399606,59.59085836472269]),p=e([.5778611961420386,57.93467822832577]),g=e([-1.25867782078448,57.99029450085142]),o.moveTo(u[0],u[1]),o.lineTo(c[0],c[1]),o.lineTo(p[0],p[1]),o.lineTo(g[0],g[1]),o.closePath()},h.getCompositionBorders=function(){var o=Wi();return this.drawCompositionBorders(o),o.toString()},h.scale(2800)}function gl(n){const t=+this._x.call(null,n),e=+this._y.call(null,n);return Ui(this.cover(t,e),t,e,n)}function Ui(n,t,e,i){if(isNaN(t)||isNaN(e))return n;var r,l=n._root,s={data:i},a=n._x0,h=n._y0,f=n._x1,o=n._y1,u,c,p,g,v,d,_,m;if(!l)return n._root=s,n;for(;l.length;)if((v=t>=(u=(a+f)/2))?a=u:f=u,(d=e>=(c=(h+o)/2))?h=c:o=c,r=l,!(l=l[_=d<<1|v]))return r[_]=s,n;if(p=+n._x.call(null,l.data),g=+n._y.call(null,l.data),t===p&&e===g)return s.next=l,r?r[_]=s:n._root=s,n;do r=r?r[_]=new Array(4):n._root=new Array(4),(v=t>=(u=(a+f)/2))?a=u:f=u,(d=e>=(c=(h+o)/2))?h=c:o=c;while((_=d<<1|v)===(m=(g>=c)<<1|p>=u));return r[m]=l,r[_]=s,n}function dl(n){var t,e,i=n.length,r,l,s=new Array(i),a=new Array(i),h=1/0,f=1/0,o=-1/0,u=-1/0;for(e=0;e<i;++e)isNaN(r=+this._x.call(null,t=n[e]))||isNaN(l=+this._y.call(null,t))||(s[e]=r,a[e]=l,r<h&&(h=r),r>o&&(o=r),l<f&&(f=l),l>u&&(u=l));if(h>o||f>u)return this;for(this.cover(h,f).cover(o,u),e=0;e<i;++e)Ui(this,s[e],a[e],n[e]);return this}function _l(n,t){if(isNaN(n=+n)||isNaN(t=+t))return this;var e=this._x0,i=this._y0,r=this._x1,l=this._y1;if(isNaN(e))r=(e=Math.floor(n))+1,l=(i=Math.floor(t))+1;else{for(var s=r-e||1,a=this._root,h,f;e>n||n>=r||i>t||t>=l;)switch(f=(t<i)<<1|n<e,h=new Array(4),h[f]=a,a=h,s*=2,f){case 0:r=e+s,l=i+s;break;case 1:e=r-s,l=i+s;break;case 2:r=e+s,i=l-s;break;case 3:e=r-s,i=l-s;break}this._root&&this._root.length&&(this._root=a)}return this._x0=e,this._y0=i,this._x1=r,this._y1=l,this}function vl(){var n=[];return this.visit(function(t){if(!t.length)do n.push(t.data);while(t=t.next)}),n}function wl(n){return arguments.length?this.cover(+n[0][0],+n[0][1]).cover(+n[1][0],+n[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Q(n,t,e,i,r){this.node=n,this.x0=t,this.y0=e,this.x1=i,this.y1=r}function yl(n,t,e){var i,r=this._x0,l=this._y0,s,a,h,f,o=this._x1,u=this._y1,c=[],p=this._root,g,v;for(p&&c.push(new Q(p,r,l,o,u)),e==null?e=1/0:(r=n-e,l=t-e,o=n+e,u=t+e,e*=e);g=c.pop();)if(!(!(p=g.node)||(s=g.x0)>o||(a=g.y0)>u||(h=g.x1)<r||(f=g.y1)<l))if(p.length){var d=(s+h)/2,_=(a+f)/2;c.push(new Q(p[3],d,_,h,f),new Q(p[2],s,_,d,f),new Q(p[1],d,a,h,_),new Q(p[0],s,a,d,_)),(v=(t>=_)<<1|n>=d)&&(g=c[c.length-1],c[c.length-1]=c[c.length-1-v],c[c.length-1-v]=g)}else{var m=n-+this._x.call(null,p.data),w=t-+this._y.call(null,p.data),y=m*m+w*w;if(y<e){var C=Math.sqrt(e=y);r=n-C,l=t-C,o=n+C,u=t+C,i=p.data}}return i}function ml(n){if(isNaN(o=+this._x.call(null,n))||isNaN(u=+this._y.call(null,n)))return this;var t,e=this._root,i,r,l,s=this._x0,a=this._y0,h=this._x1,f=this._y1,o,u,c,p,g,v,d,_;if(!e)return this;if(e.length)for(;;){if((g=o>=(c=(s+h)/2))?s=c:h=c,(v=u>=(p=(a+f)/2))?a=p:f=p,t=e,!(e=e[d=v<<1|g]))return this;if(!e.length)break;(t[d+1&3]||t[d+2&3]||t[d+3&3])&&(i=t,_=d)}for(;e.data!==n;)if(r=e,!(e=e.next))return this;return(l=e.next)&&delete e.next,r?(l?r.next=l:delete r.next,this):t?(l?t[d]=l:delete t[d],(e=t[0]||t[1]||t[2]||t[3])&&e===(t[3]||t[2]||t[1]||t[0])&&!e.length&&(i?i[_]=e:this._root=e),this):(this._root=l,this)}function Sl(n){for(var t=0,e=n.length;t<e;++t)this.remove(n[t]);return this}function Cl(){return this._root}function El(){var n=0;return this.visit(function(t){if(!t.length)do++n;while(t=t.next)}),n}function Nl(n){var t=[],e,i=this._root,r,l,s,a,h;for(i&&t.push(new Q(i,this._x0,this._y0,this._x1,this._y1));e=t.pop();)if(!n(i=e.node,l=e.x0,s=e.y0,a=e.x1,h=e.y1)&&i.length){var f=(l+a)/2,o=(s+h)/2;(r=i[3])&&t.push(new Q(r,f,o,a,h)),(r=i[2])&&t.push(new Q(r,l,o,f,h)),(r=i[1])&&t.push(new Q(r,f,s,a,o)),(r=i[0])&&t.push(new Q(r,l,s,f,o))}return this}function Pl(n){var t=[],e=[],i;for(this._root&&t.push(new Q(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var r=i.node;if(r.length){var l,s=i.x0,a=i.y0,h=i.x1,f=i.y1,o=(s+h)/2,u=(a+f)/2;(l=r[0])&&t.push(new Q(l,s,a,o,u)),(l=r[1])&&t.push(new Q(l,o,a,h,u)),(l=r[2])&&t.push(new Q(l,s,u,o,f)),(l=r[3])&&t.push(new Q(l,o,u,h,f))}e.push(i)}for(;i=e.pop();)n(i.node,i.x0,i.y0,i.x1,i.y1);return this}function bl(n){return n[0]}function Ml(n){return arguments.length?(this._x=n,this):this._x}function Al(n){return n[1]}function Ll(n){return arguments.length?(this._y=n,this):this._y}function Hi(n,t,e){var i=new Ce(t??bl,e??Al,NaN,NaN,NaN,NaN);return n==null?i:i.addAll(n)}function Ce(n,t,e,i,r,l){this._x=n,this._y=t,this._x0=e,this._y0=i,this._x1=r,this._y1=l,this._root=void 0}function ei(n){for(var t={data:n.data},e=t;n=n.next;)e=e.next={data:n.data};return t}var V=Hi.prototype=Ce.prototype;V.copy=function(){var n=new Ce(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,e,i;if(!t)return n;if(!t.length)return n._root=ei(t),n;for(e=[{source:t,target:n._root=new Array(4)}];t=e.pop();)for(var r=0;r<4;++r)(i=t.source[r])&&(i.length?e.push({source:i,target:t.target[r]=new Array(4)}):t.target[r]=ei(i));return n};V.add=gl;V.addAll=dl;V.cover=_l;V.data=vl;V.extent=wl;V.find=yl;V.remove=ml;V.removeAll=Sl;V.root=Cl;V.size=El;V.visit=Nl;V.visitAfter=Pl;V.x=Ml;V.y=Ll;function ii(n){return function(){return n}}function ri(n){return(n()-.5)*1e-6}function Ol(n){return n.x+n.vx}function $l(n){return n.y+n.vy}function kl(n){var t,e,i,r=1,l=1;typeof n!="function"&&(n=ii(n==null?1:+n));function s(){for(var f,o=t.length,u,c,p,g,v,d,_=0;_<l;++_)for(u=Hi(t,Ol,$l).visitAfter(a),f=0;f<o;++f)c=t[f],v=e[c.index],d=v*v,p=c.x+c.vx,g=c.y+c.vy,u.visit(m);function m(w,y,C,O,E){var L=w.data,A=w.r,N=v+A;if(L){if(L.index>c.index){var M=p-L.x-L.vx,D=g-L.y-L.vy,T=M*M+D*D;T<N*N&&(M===0&&(M=ri(i),T+=M*M),D===0&&(D=ri(i),T+=D*D),T=(N-(T=Math.sqrt(T)))/T*r,c.vx+=(M*=T)*(N=(A*=A)/(d+A)),c.vy+=(D*=T)*N,L.vx-=M*(N=1-N),L.vy-=D*N)}return}return y>p+N||O<p-N||C>g+N||E<g-N}}function a(f){if(f.data)return f.r=e[f.data.index];for(var o=f.r=0;o<4;++o)f[o]&&f[o].r>f.r&&(f.r=f[o].r)}function h(){if(t){var f,o=t.length,u;for(e=new Array(o),f=0;f<o;++f)u=t[f],e[u.index]=+n(u,f,t)}}return s.initialize=function(f,o){t=f,i=o,h()},s.iterations=function(f){return arguments.length?(l=+f,s):l},s.strength=function(f){return arguments.length?(r=+f,s):r},s.radius=function(f){return arguments.length?(n=typeof f=="function"?f:ii(+f),h(),s):n},s}var Dl={value:()=>{}};function Zi(){for(var n=0,t=arguments.length,e={},i;n<t;++n){if(!(i=arguments[n]+"")||i in e||/[\s.]/.test(i))throw new Error("illegal type: "+i);e[i]=[]}return new wt(e)}function wt(n){this._=n}function Tl(n,t){return n.trim().split(/^|\s+/).map(function(e){var i="",r=e.indexOf(".");if(r>=0&&(i=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:i}})}wt.prototype=Zi.prototype={constructor:wt,on:function(n,t){var e=this._,i=Tl(n+"",e),r,l=-1,s=i.length;if(arguments.length<2){for(;++l<s;)if((r=(n=i[l]).type)&&(r=Rl(e[r],n.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++l<s;)if(r=(n=i[l]).type)e[r]=li(e[r],n.name,t);else if(t==null)for(r in e)e[r]=li(e[r],n.name,null);return this},copy:function(){var n={},t=this._;for(var e in t)n[e]=t[e].slice();return new wt(n)},call:function(n,t){if((r=arguments.length-2)>0)for(var e=new Array(r),i=0,r,l;i<r;++i)e[i]=arguments[i+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(l=this._[n],i=0,r=l.length;i<r;++i)l[i].value.apply(t,e)},apply:function(n,t,e){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var i=this._[n],r=0,l=i.length;r<l;++r)i[r].value.apply(t,e)}};function Rl(n,t){for(var e=0,i=n.length,r;e<i;++e)if((r=n[e]).name===t)return r.value}function li(n,t,e){for(var i=0,r=n.length;i<r;++i)if(n[i].name===t){n[i]=Dl,n=n.slice(0,i).concat(n.slice(i+1));break}return e!=null&&n.push({name:t,value:e}),n}var Gn=0,Kn=0,Un=0,Yi=1e3,Dt,nt,Tt=0,En=0,It=0,st=typeof performance=="object"&&performance.now?performance:Date,Xi=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(n){setTimeout(n,17)};function Qi(){return En||(Xi(Il),En=st.now()+It)}function Il(){En=0}function pe(){this._call=this._time=this._next=null}pe.prototype=Vi.prototype={constructor:pe,restart:function(n,t,e){if(typeof n!="function")throw new TypeError("callback is not a function");e=(e==null?Qi():+e)+(t==null?0:+t),!this._next&&nt!==this&&(nt?nt._next=this:Dt=this,nt=this),this._call=n,this._time=e,ge()},stop:function(){this._call&&(this._call=null,this._time=1/0,ge())}};function Vi(n,t,e){var i=new pe;return i.restart(n,t,e),i}function Fl(){Qi(),++Gn;for(var n=Dt,t;n;)(t=En-n._time)>=0&&n._call.call(void 0,t),n=n._next;--Gn}function oi(){En=(Tt=st.now())+It,Gn=Kn=0;try{Fl()}finally{Gn=0,zl(),En=0}}function ql(){var n=st.now(),t=n-Tt;t>Yi&&(It-=t,Tt=n)}function zl(){for(var n,t=Dt,e,i=1/0;t;)t._call?(i>t._time&&(i=t._time),n=t,t=t._next):(e=t._next,t._next=null,t=n?n._next=e:Dt=e);nt=n,ge(i)}function ge(n){if(!Gn){Kn&&(Kn=clearTimeout(Kn));var t=n-En;t>24?(n<1/0&&(Kn=setTimeout(oi,n-st.now()-It)),Un&&(Un=clearInterval(Un))):(Un||(Tt=st.now(),Un=setInterval(ql,Yi)),Gn=1,Xi(oi))}}const Gl=1664525,Bl=1013904223,si=4294967296;function xl(){let n=1;return()=>(n=(Gl*n+Bl)%si)/si}var jl=10,Wl=Math.PI*(3-Math.sqrt(5));function Ul(n){var t,e=1,i=.001,r=1-Math.pow(i,1/300),l=0,s=.6,a=new Map,h=Vi(u),f=Zi("tick","end"),o=xl();n==null&&(n=[]);function u(){c(),f.call("tick",t),e<i&&(h.stop(),f.call("end",t))}function c(v){var d,_=n.length,m;v===void 0&&(v=1);for(var w=0;w<v;++w)for(e+=(l-e)*r,a.forEach(function(y){y(e)}),d=0;d<_;++d)m=n[d],m.fx==null?m.x+=m.vx*=s:(m.x=m.fx,m.vx=0),m.fy==null?m.y+=m.vy*=s:(m.y=m.fy,m.vy=0);return t}function p(){for(var v=0,d=n.length,_;v<d;++v){if(_=n[v],_.index=v,_.fx!=null&&(_.x=_.fx),_.fy!=null&&(_.y=_.fy),isNaN(_.x)||isNaN(_.y)){var m=jl*Math.sqrt(.5+v),w=v*Wl;_.x=m*Math.cos(w),_.y=m*Math.sin(w)}(isNaN(_.vx)||isNaN(_.vy))&&(_.vx=_.vy=0)}}function g(v){return v.initialize&&v.initialize(n,o),v}return p(),t={tick:c,restart:function(){return h.restart(u),t},stop:function(){return h.stop(),t},nodes:function(v){return arguments.length?(n=v,p(),a.forEach(g),t):n},alpha:function(v){return arguments.length?(e=+v,t):e},alphaMin:function(v){return arguments.length?(i=+v,t):i},alphaDecay:function(v){return arguments.length?(r=+v,t):+r},alphaTarget:function(v){return arguments.length?(l=+v,t):l},velocityDecay:function(v){return arguments.length?(s=1-v,t):1-s},randomSource:function(v){return arguments.length?(o=v,a.forEach(g),t):o},force:function(v,d){return arguments.length>1?(d==null?a.delete(v):a.set(v,g(d)),t):a.get(v)},find:function(v,d,_){var m=0,w=n.length,y,C,O,E,L;for(_==null?_=1/0:_*=_,m=0;m<w;++m)E=n[m],y=v-E.x,C=d-E.y,O=y*y+C*C,O<_&&(L=E,_=O);return L},on:function(v,d){return arguments.length>1?(f.on(v,d),t):f.on(v)}}}const{Map:ui}=er;function fi(n,t,e){const i=n.slice();return i[16]=t[e],i[17]=t,i[18]=e,i}function ai(n,t,e){const i=n.slice();return i[19]=t[e],i}function ci(n){let t,e,i,r,l,s,a,h,f,o=[],u=new ui,c,p=[],g=new ui,v=vn(n[4]);const d=w=>w[19].properties.PCON25CD;for(let w=0;w<v.length;w+=1){let y=ai(n,v,w),C=d(y);u.set(C,o[w]=hi(C,y))}let _=vn(n[6]);const m=w=>w[16].PCON25CD;for(let w=0;w<_.length;w+=1){let y=fi(n,_,w),C=m(y);g.set(C,p[w]=pi(C,y))}return{c(){t=pn("svg"),e=pn("g"),i=pn("circle"),r=pn("text"),l=B("Held constituency"),s=pn("circle"),a=pn("text"),h=B("Constituency changing hands"),f=pn("g");for(let w=0;w<o.length;w+=1)o[w].c();c=Rt();for(let w=0;w<p.length;w+=1)p[w].c();b(i,"class","constituency Lab svelte-3op49b"),b(i,"cx","320"),b(i,"cy",160-An),b(i,"r",An),b(r,"x","330"),b(r,"y","160"),b(s,"class","constituency Lab new-winner svelte-3op49b"),b(s,"cx","320"),b(s,"cy",180-An),b(s,"r",An),b(a,"x","330"),b(a,"y","180"),b(e,"class","key"),b(t,"id","map"),b(t,"class","svelte-3op49b")},m(w,y){x(w,t,y),P(t,e),P(e,i),P(e,r),P(r,l),P(e,s),P(e,a),P(a,h),P(t,f);for(let C=0;C<o.length;C+=1)o[C]&&o[C].m(f,null);P(f,c);for(let C=0;C<p.length;C+=1)p[C]&&p[C].m(f,null)},p(w,y){y&48&&(v=vn(w[4]),o=Me(o,y,d,1,w,v,u,f,be,hi,c,ai)),y&1987&&(_=vn(w[6]),p=Me(p,y,m,1,w,_,g,f,be,pi,null,fi))},d(w){w&&z(t);for(let y=0;y<o.length;y+=1)o[y].d();for(let y=0;y<p.length;y+=1)p[y].d()}}}function hi(n,t){let e,i;return{key:n,first:null,c(){e=pn("path"),b(e,"class",Ht("background")+" svelte-3op49b"),b(e,"d",i=t[5](t[19])),this.first=e},m(r,l){x(r,e,l)},p(r,l){t=r,l&48&&i!==(i=t[5](t[19]))&&b(e,"d",i)},d(r){r&&z(e)}}}function pi(n,t){let e,i,r,l,s=t[17],a=t[18],h,f;const o=()=>t[12](e,s,a),u=()=>t[12](null,s,a);function c(){return t[13](t[16])}function p(){return t[14](t[16])}return{key:n,first:null,c(){e=pn("circle"),b(e,"class",i=Ht("constituency "+t[8](t[1],t[16].PCON25CD)+(t[0]!=null&&t[0].properties.PCON25CD==t[16].PCON25CD?" selected":"")+(t[9](t[1],t[16].PCON25CD)?" new-winner":""))+" svelte-3op49b"),b(e,"cx",r=t[16].x),b(e,"cy",l=t[16].y),b(e,"r",An),this.first=e},m(g,v){x(g,e,v),o(),h||(f=[an(e,"mouseenter",c),an(e,"mouseleave",function(){de(t[16].element.classList.remove("hovered"))&&t[16].element.classList.remove("hovered").apply(this,arguments)}),an(e,"click",p)],h=!0)},p(g,v){t=g,v&67&&i!==(i=Ht("constituency "+t[8](t[1],t[16].PCON25CD)+(t[0]!=null&&t[0].properties.PCON25CD==t[16].PCON25CD?" selected":"")+(t[9](t[1],t[16].PCON25CD)?" new-winner":""))+" svelte-3op49b")&&b(e,"class",i),v&64&&r!==(r=t[16].x)&&b(e,"cx",r),v&64&&l!==(l=t[16].y)&&b(e,"cy",l),(s!==t[17]||a!==t[18])&&(u(),s=t[17],a=t[18],o())},d(g){g&&z(e),u(),h=!1,_n(f)}}}function Hl(n){let t,e,i;mt(n[11]);let r=n[4]&&ci(n);return{c(){r&&r.c(),t=Rt()},m(l,s){r&&r.m(l,s),x(l,t,s),e||(i=an(window,"resize",n[11]),e=!0)},p(l,[s]){l[4]?r?r.p(l,s):(r=ci(l),r.c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null)},i:K,o:K,d(l){l&&z(t),r&&r.d(l),e=!1,i()}}}let An=6;function Zl(n,t,e){let i,r,{results:l}=t,s,{selected:a}=t,h,f,o=[],u=!1;fetch("./data/constituencies.json").then(w=>w.json()).then(w=>{console.log("loading topojson"),e(4,s=pr(w,w.objects.constituencies).features),f=pl().fitExtent([[200,200],[r,i]],{type:"FeatureCollection",features:s}),e(6,o=s.map(C=>({PCON25CD:C.properties.PCON25CD,x:f([C.properties.LONG,C.properties.LAT])[0],y:f([C.properties.LONG,C.properties.LAT])[1]}))),e(5,h=Or(f));const y=Ul(o).force("collision",kl().radius(An+1).strength(1));y.on("tick",()=>{console.log("tick"),e(6,o=y.nodes())})});const c=(w,y)=>w.filter(C=>C.PCON25CD==y)[0].winner,p=(w,y)=>{const C=w.filter(O=>O.PCON25CD==y)[0];return C.winner19=="Spkr"?!1:C.winner!=C.winner19},g=w=>e(0,a=s.filter(y=>y.properties.PCON25CD==w)[0]);function v(){e(2,i=window.innerHeight),e(3,r=window.innerWidth)}function d(w,y,C){kn[w?"unshift":"push"](()=>{y[C].element=w,e(6,o)})}const _=w=>{w.element.classList.add("hovered"),g(w.PCON25CD)},m=w=>{e(7,u=!0),g(w.PCON25CD)};return n.$$set=w=>{"results"in w&&e(1,l=w.results),"selected"in w&&e(0,a=w.selected)},[a,l,i,r,s,h,o,u,c,p,g,v,d,_,m]}let Yl=class extends jn{constructor(t){super(),xn(this,t,Zl,Hl,Bn,{results:1,selected:0})}};function Xl(n){let t,e,i,r,l,s=n[0].Lab+"",a,h,f,o,u,c,p,g=n[0].Con+"",v,d,_,m,w,y,C,O,E,L=n[0].LD+"",A,N,M,D,T,I,S,$=n[0].PC+"",H,Z;return{c(){t=k("div"),e=k("div"),i=B("Labour"),r=k("br"),l=k("span"),a=B(s),f=j(),o=k("div"),u=B("Conservatives"),c=k("br"),p=k("span"),v=B(g),_=j(),m=k("br"),w=j(),y=k("div"),C=B("Liberal Democrats"),O=k("br"),E=k("span"),A=B(L),M=j(),D=k("div"),T=B("Plaid Cymru"),I=k("br"),S=k("span"),H=B($),b(l,"class","tally-num svelte-164eunb"),b(e,"class","tally-card svelte-164eunb"),b(e,"style",h=n[0].Lab>=n[0].Con?"left:0px":"left:150px"),b(p,"class","tally-num svelte-164eunb"),b(o,"class","tally-card svelte-164eunb"),b(o,"style",d=n[0].Lab<n[0].Con?"left:-150px":"left:0px"),b(E,"class","tally-num svelte-164eunb"),b(y,"class","tally-card svelte-164eunb"),b(y,"style",N=n[0].LD>=n[0].PC?"left:0px":"left:150px"),b(S,"class","tally-num svelte-164eunb"),b(D,"class","tally-card svelte-164eunb"),b(D,"style",Z=n[0].PC>n[0].LD?"left:-150px":"left:0px"),b(t,"class","tally-container svelte-164eunb")},m(F,Y){x(F,t,Y),P(t,e),P(e,i),P(e,r),P(e,l),P(l,a),P(t,f),P(t,o),P(o,u),P(o,c),P(o,p),P(p,v),P(t,_),P(t,m),P(t,w),P(t,y),P(y,C),P(y,O),P(y,E),P(E,A),P(t,M),P(t,D),P(D,T),P(D,I),P(D,S),P(S,H)},p(F,[Y]){Y&1&&s!==(s=F[0].Lab+"")&&en(a,s),Y&1&&h!==(h=F[0].Lab>=F[0].Con?"left:0px":"left:150px")&&b(e,"style",h),Y&1&&g!==(g=F[0].Con+"")&&en(v,g),Y&1&&d!==(d=F[0].Lab<F[0].Con?"left:-150px":"left:0px")&&b(o,"style",d),Y&1&&L!==(L=F[0].LD+"")&&en(A,L),Y&1&&N!==(N=F[0].LD>=F[0].PC?"left:0px":"left:150px")&&b(y,"style",N),Y&1&&$!==($=F[0].PC+"")&&en(H,$),Y&1&&Z!==(Z=F[0].PC>F[0].LD?"left:-150px":"left:0px")&&b(D,"style",Z)},i:K,o:K,d(F){F&&z(t)}}}function Ql(n,t,e){let{seat_tally:i}=t;return n.$$set=r=>{"seat_tally"in r&&e(0,i=r.seat_tally)},[i]}class Vl extends jn{constructor(t){super(),xn(this,t,Ql,Xl,Bn,{seat_tally:0})}}function Jl(n){let t,e,i,r,l,s,a=n[0]==0?"No change":Math.abs(n[0])+"%",h,f,o,u,c,p,g,v,d,_,m,w;return{c(){t=k("label"),e=k("p"),e.textContent="Change the national swing",i=j(),r=k("div"),l=k("p"),s=k("strong"),h=B(a),f=j(),o=k("div"),u=k("span"),u.textContent="Con",c=j(),p=k("input"),g=j(),v=k("span"),v.textContent="Lab",d=j(),_=k("button"),_.textContent="Reset",b(e,"class","svelte-1jptu2d"),b(t,"for",n[1]),b(t,"class","svelte-1jptu2d"),b(l,"class","svelte-1jptu2d"),b(u,"class","slider-labels svelte-1jptu2d"),b(p,"id",n[1]),b(p,"type","range"),b(p,"min","-20"),b(p,"max","20"),b(p,"class","svelte-1jptu2d"),b(v,"class","slider-labels svelte-1jptu2d"),b(o,"class","slider svelte-1jptu2d"),b(_,"class","reset svelte-1jptu2d"),b(r,"class","slider-container svelte-1jptu2d")},m(y,C){x(y,t,C),P(t,e),x(y,i,C),x(y,r,C),P(r,l),P(l,s),P(s,h),P(r,f),P(r,o),P(o,u),P(o,c),P(o,p),yt(p,n[0]),P(o,g),P(o,v),P(r,d),P(r,_),m||(w=[an(p,"change",n[2]),an(p,"input",n[2]),an(_,"click",n[3])],m=!0)},p(y,[C]){C&2&&b(t,"for",y[1]),C&1&&a!==(a=y[0]==0?"No change":Math.abs(y[0])+"%")&&en(h,a),C&2&&b(p,"id",y[1]),C&1&&yt(p,y[0])},i:K,o:K,d(y){y&&(z(t),z(i),z(r)),m=!1,_n(w)}}}function Kl(n,t,e){let{swing:i=0}=t,{id:r}=t;function l(){i=Ni(this.value),e(0,i)}const s=()=>e(0,i=0);return n.$$set=a=>{"swing"in a&&e(0,i=a.swing),"id"in a&&e(1,r=a.id)},[i,r,l,s]}class no extends jn{constructor(t){super(),xn(this,t,Kl,Jl,Bn,{swing:0,id:1})}}function to(n){let t,e,i,r,l,s,a,h,f,o,u,c,p;return{c(){t=k("div"),e=k("div"),i=k("span"),r=B(n[2]),l=j(),s=k("span"),a=B(n[3]),h=j(),f=k("input"),o=j(),u=k("button"),u.textContent="Reset",b(i,"class","slider-labels svelte-7yblge"),b(s,"class","slider-labels svelte-7yblge"),b(f,"id",n[1]),b(f,"type","range"),b(f,"min","-10"),b(f,"max","10"),b(f,"class","svelte-7yblge"),b(u,"class","reset svelte-7yblge"),b(e,"class","slider svelte-7yblge"),b(t,"class","slider-container svelte-7yblge")},m(g,v){x(g,t,v),P(t,e),P(e,i),P(i,r),P(e,l),P(e,s),P(s,a),P(e,h),P(e,f),yt(f,n[0]),P(e,o),P(e,u),c||(p=[an(f,"change",n[4]),an(f,"input",n[4]),an(u,"click",n[5])],c=!0)},p(g,[v]){v&4&&en(r,g[2]),v&8&&en(a,g[3]),v&2&&b(f,"id",g[1]),v&1&&yt(f,g[0])},i:K,o:K,d(g){g&&z(t),c=!1,_n(p)}}}function eo(n,t,e){let{swing:i=0}=t,{id:r}=t,{low:l}=t,{high:s}=t;function a(){i=Ni(this.value),e(0,i)}const h=()=>e(0,i=0);return n.$$set=f=>{"swing"in f&&e(0,i=f.swing),"id"in f&&e(1,r=f.id),"low"in f&&e(2,l=f.low),"high"in f&&e(3,s=f.high)},[i,r,l,s,a,h]}class io extends jn{constructor(t){super(),xn(this,t,eo,to,Bn,{swing:0,id:1,low:2,high:3})}}function gi(n,t,e){const i=n.slice();return i[2]=t[e],i}function ro(n){let t,e=n[0].properties.PCON25NM+"",i,r,l,s,a,h=vn(n[1]),f=[];for(let o=0;o<h.length;o+=1)f[o]=di(gi(n,h,o));return{c(){t=k("strong"),i=B(e),r=j(),l=k("br"),s=j();for(let o=0;o<f.length;o+=1)f[o].c();a=Rt()},m(o,u){x(o,t,u),P(t,i),x(o,r,u),x(o,l,u),x(o,s,u);for(let c=0;c<f.length;c+=1)f[c]&&f[c].m(o,u);x(o,a,u)},p(o,u){if(u&1&&e!==(e=o[0].properties.PCON25NM+"")&&en(i,e),u&2){h=vn(o[1]);let c;for(c=0;c<h.length;c+=1){const p=gi(o,h,c);f[c]?f[c].p(p,u):(f[c]=di(p),f[c].c(),f[c].m(a.parentNode,a))}for(;c<f.length;c+=1)f[c].d(1);f.length=h.length}},d(o){o&&(z(t),z(r),z(l),z(s),z(a)),Ei(f,o)}}}function lo(n){let t;return{c(){t=B("Click or hover over a constituency to see its modelled results.")},m(e,i){x(e,t,i)},p:K,d(e){e&&z(t)}}}function oo(n){let t,e,i=n[2].party+"",r,l,s=Math.round(n[2].perc*10)/10+"",a,h;return{c(){t=k("br"),e=j(),r=B(i),l=B(":  "),a=B(s),h=B("%")},m(f,o){x(f,t,o),x(f,e,o),x(f,r,o),x(f,l,o),x(f,a,o),x(f,h,o)},p(f,o){o&2&&i!==(i=f[2].party+"")&&en(r,i),o&2&&s!==(s=Math.round(f[2].perc*10)/10+"")&&en(a,s)},d(f){f&&(z(t),z(e),z(r),z(l),z(a),z(h))}}}function so(n){let t,e,i,r=n[2].party+"",l,s,a=Math.round(n[2].perc*10)/10+"",h,f;return{c(){t=k("strong"),e=k("br"),i=j(),l=B(r),s=B(":  "),h=B(a),f=B(`%
          `)},m(o,u){x(o,t,u),P(t,e),P(t,i),P(t,l),P(t,s),P(t,h),P(t,f)},p(o,u){u&2&&r!==(r=o[2].party+"")&&en(l,r),u&2&&a!==(a=Math.round(o[2].perc*10)/10+"")&&en(h,a)},d(o){o&&z(t)}}}function di(n){let t;function e(l,s){return l[2]==l[1][0]?so:oo}let i=e(n),r=i(n);return{c(){r.c(),t=Rt()},m(l,s){r.m(l,s),x(l,t,s)},p(l,s){i===(i=e(l))&&r?r.p(l,s):(r.d(1),r=i(l),r&&(r.c(),r.m(t.parentNode,t)))},d(l){l&&z(t),r.d(l)}}}function uo(n){let t;function e(l,s){return l[0]==null?lo:ro}let i=e(n),r=i(n);return{c(){t=k("div"),r.c(),b(t,"class","infobox-container svelte-eep1jc")},m(l,s){x(l,t,s),r.m(t,null)},p(l,[s]){i===(i=e(l))&&r?r.p(l,s):(r.d(1),r=i(l),r&&(r.c(),r.m(t,null)))},i:K,o:K,d(l){l&&z(t),r.d()}}}function fo(n,t,e){let{selected:i}=t,{selected_results:r}=t;return n.$$set=l=>{"selected"in l&&e(0,i=l.selected),"selected_results"in l&&e(1,r=l.selected_results)},[i,r]}class ao extends jn{constructor(t){super(),xn(this,t,fo,uo,Bn,{selected:0,selected_results:1})}}var _i={},jt={},Wt=34,Hn=10,Ut=13;function Ji(n){return new Function("d","return {"+n.map(function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'}).join(",")+"}")}function co(n,t){var e=Ji(n);return function(i,r){return t(e(i),r,n)}}function vi(n){var t=Object.create(null),e=[];return n.forEach(function(i){for(var r in i)r in t||e.push(t[r]=r)}),e}function J(n,t){var e=n+"",i=e.length;return i<t?new Array(t-i+1).join(0)+e:e}function ho(n){return n<0?"-"+J(-n,6):n>9999?"+"+J(n,6):J(n,4)}function po(n){var t=n.getUTCHours(),e=n.getUTCMinutes(),i=n.getUTCSeconds(),r=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":ho(n.getUTCFullYear())+"-"+J(n.getUTCMonth()+1,2)+"-"+J(n.getUTCDate(),2)+(r?"T"+J(t,2)+":"+J(e,2)+":"+J(i,2)+"."+J(r,3)+"Z":i?"T"+J(t,2)+":"+J(e,2)+":"+J(i,2)+"Z":e||t?"T"+J(t,2)+":"+J(e,2)+"Z":"")}function go(n){var t=new RegExp('["'+n+`
\r]`),e=n.charCodeAt(0);function i(u,c){var p,g,v=r(u,function(d,_){if(p)return p(d,_-1);g=d,p=c?co(d,c):Ji(d)});return v.columns=g||[],v}function r(u,c){var p=[],g=u.length,v=0,d=0,_,m=g<=0,w=!1;u.charCodeAt(g-1)===Hn&&--g,u.charCodeAt(g-1)===Ut&&--g;function y(){if(m)return jt;if(w)return w=!1,_i;var O,E=v,L;if(u.charCodeAt(E)===Wt){for(;v++<g&&u.charCodeAt(v)!==Wt||u.charCodeAt(++v)===Wt;);return(O=v)>=g?m=!0:(L=u.charCodeAt(v++))===Hn?w=!0:L===Ut&&(w=!0,u.charCodeAt(v)===Hn&&++v),u.slice(E+1,O-1).replace(/""/g,'"')}for(;v<g;){if((L=u.charCodeAt(O=v++))===Hn)w=!0;else if(L===Ut)w=!0,u.charCodeAt(v)===Hn&&++v;else if(L!==e)continue;return u.slice(E,O)}return m=!0,u.slice(E,g)}for(;(_=y())!==jt;){for(var C=[];_!==_i&&_!==jt;)C.push(_),_=y();c&&(C=c(C,d++))==null||p.push(C)}return p}function l(u,c){return u.map(function(p){return c.map(function(g){return o(p[g])}).join(n)})}function s(u,c){return c==null&&(c=vi(u)),[c.map(o).join(n)].concat(l(u,c)).join(`
`)}function a(u,c){return c==null&&(c=vi(u)),l(u,c).join(`
`)}function h(u){return u.map(f).join(`
`)}function f(u){return u.map(o).join(n)}function o(u){return u==null?"":u instanceof Date?po(u):t.test(u+="")?'"'+u.replace(/"/g,'""')+'"':u}return{parse:i,parseRows:r,format:s,formatBody:a,formatRows:h,formatRow:f,formatValue:o}}var _o=go(","),wi=_o.parse;function yi(n,t,e){const i=n.slice();return i[14]=t[e],i[15]=t,i[16]=e,i}function mi(n){let t,e,i;function r(s){n[8](s,n[14])}let l={id:n[14].name,low:n[14].low,high:n[14].high};return n[14].swing!==void 0&&(l.swing=n[14].swing),t=new io({props:l}),kn.push(()=>we(t,"swing",r)),{c(){et(t.$$.fragment)},m(s,a){On(t,s,a),i=!0},p(s,a){n=s;const h={};a&4&&(h.id=n[14].name),a&4&&(h.low=n[14].low),a&4&&(h.high=n[14].high),!e&&a&4&&(e=!0,h.swing=n[14].swing,ve(()=>e=!1)),t.$set(h)},i(s){i||(nn(t.$$.fragment,s),i=!0)},o(s){gn(t.$$.fragment,s),i=!1},d(s){$n(t,s)}}}function Si(n){let t,e,i;function r(s){n[9](s)}let l={results:n[0]};return n[3]!==void 0&&(l.selected=n[3]),t=new Yl({props:l}),kn.push(()=>we(t,"selected",r)),{c(){et(t.$$.fragment)},m(s,a){On(t,s,a),i=!0},p(s,a){const h={};a&1&&(h.results=s[0]),!e&&a&8&&(e=!0,h.selected=s[3],ve(()=>e=!1)),t.$set(h)},i(s){i||(nn(t.$$.fragment,s),i=!0)},o(s){gn(t.$$.fragment,s),i=!1},d(s){$n(t,s)}}}function vo(n){let t,e,i,r,l,s,a,h,f,o,u,c,p,g,v,d,_,m,w;a=new Vl({props:{seat_tally:n[5]}}),f=new ao({props:{selected:n[3],selected_results:n[4]}});function y(N){n[7](N)}let C={id:"overall"};n[1]!==void 0&&(C.swing=n[1]),u=new no({props:C}),kn.push(()=>we(u,"swing",y));let O=vn(n[2]),E=[];for(let N=0;N<O.length;N+=1)E[N]=mi(yi(n,O,N));const L=N=>gn(E[N],1,1,()=>{E[N]=null});let A=n[0]&&Si(n);return{c(){t=k("main"),e=k("h1"),e.textContent="How will swings in demographic groups change the election?",i=j(),r=k("div"),l=k("p"),l.textContent="Seats in England and Wales",s=j(),et(a.$$.fragment),h=j(),et(f.$$.fragment),o=j(),et(u.$$.fragment),p=j(),g=k("p"),g.textContent="Redistribute predicted Labour vote share between different voter groups with the sliders below to see how they can change electoral outcomes.",v=j();for(let N=0;N<E.length;N+=1)E[N].c();d=j(),_=k("p"),_.innerHTML=`The next will be the first election with new boundaries, so this model&#39;s baselines is the estimates of how the 2019 election would have looked in the new constituencies, as calculated by Rallings and Thrasher.
    <br/><br/>Northern Ireland and Scotland are not included (although existing Scottish seat results are included in the seat totals) - there are different parties in play and so they should be modelled separately.
    <br/><br/>In England and Wales, current polling indicates there will not be a significant change in the seats won by minor parties, so Labour-Conservative swing is the key factor. While it is helpful to see how different swings influence likely seat totals, it does mean that forecasts in seats where the minor parties are major players should not be taken too seriously.
    <br/><br/>Source: 2019 election estimates from Rallings and Thrasher, demographics from the ONS 2021 census`,m=j(),A&&A.c(),b(e,"class","svelte-1x6md0c"),b(l,"class","tally-header svelte-1x6md0c"),b(r,"class","right-pane svelte-1x6md0c"),b(g,"class","para svelte-1x6md0c"),b(_,"class","para below svelte-1x6md0c")},m(N,M){x(N,t,M),P(t,e),P(t,i),P(t,r),P(r,l),P(r,s),On(a,r,null),P(r,h),On(f,r,null),P(t,o),On(u,t,null),P(t,p),P(t,g),P(t,v);for(let D=0;D<E.length;D+=1)E[D]&&E[D].m(t,null);P(t,d),P(t,_),P(t,m),A&&A.m(t,null),w=!0},p(N,[M]){const D={};M&32&&(D.seat_tally=N[5]),a.$set(D);const T={};M&8&&(T.selected=N[3]),M&16&&(T.selected_results=N[4]),f.$set(T);const I={};if(!c&&M&2&&(c=!0,I.swing=N[1],ve(()=>c=!1)),u.$set(I),M&4){O=vn(N[2]);let S;for(S=0;S<O.length;S+=1){const $=yi(N,O,S);E[S]?(E[S].p($,M),nn(E[S],1)):(E[S]=mi($),E[S].c(),nn(E[S],1),E[S].m(t,d))}for(Ne(),S=O.length;S<E.length;S+=1)L(S);Pe()}N[0]?A?(A.p(N,M),M&1&&nn(A,1)):(A=Si(N),A.c(),nn(A,1),A.m(t,null)):A&&(Ne(),gn(A,1,1,()=>{A=null}),Pe())},i(N){if(!w){nn(a.$$.fragment,N),nn(f.$$.fragment,N),nn(u.$$.fragment,N);for(let M=0;M<O.length;M+=1)nn(E[M]);nn(A),w=!0}},o(N){gn(a.$$.fragment,N),gn(f.$$.fragment,N),gn(u.$$.fragment,N),E=E.filter(Boolean);for(let M=0;M<E.length;M+=1)gn(E[M]);gn(A),w=!1},d(N){N&&z(t),$n(a),$n(f),$n(u),Ei(E,N),A&&A.d()}}}function wo(n,t,e){let i,r={},l=0,s=[{name:"Age",high:"those aged over 60",low:"18 to 40 year olds",swing:0},{name:"Tenure",high:"homeowners",low:"renters",swing:0},{name:"Class",low:"upper and middle class (ABC1)",high:"working class (C2DE)",swing:0},{name:"Education",low:"those with no qualifications",high:"university graduates",swing:0}],a,h,f;fetch("./data/2019-new-constituency-estimates.csv").then(d=>d.text()).then(d=>{d=wi(d),console.log(d),e(0,i=d.map(_=>({PCON25CD:_.PCON25CD,country_name:_.country_name,winner19:_.Win19,winner:_.Win19,perc:{Con:+_["CON%"],Lab:+_["LAB%"],LD:+_["LD%"],Green:+_["GRN%"],PC:+_["PC%"],Oths:+_["Max Oths%"]},swing_perc:{Con:+_["CON%"],Lab:+_["LAB%"],LD:+_["LD%"],Green:+_["GRN%"],PC:+_["PC%"],Oths:+_["Max oths%"]}})))}),fetch("./data/merged_demographics.csv").then(d=>d.text()).then(d=>{d=wi(d),console.log(d),e(6,a=d.map(_=>({PCON25CD:_.PCON25CD,Age:{high:+_["Age:60-101"]/100,low:+_["Age:18-35"]/100},Tenure:{high:+_["Tenure:Owned"]/100,low:(+_["Tenure:Private rented"]+ +_["Tenure:Social rented"])/100},Class:{low:(+_["ASG:AB"]+ +_["ASG:C1"])/100,high:(+_["ASG:C2"]+ +_["ASG:DE"])/100},Education:{low:+_["Education:No qualifications"]/100,high:+_["Education:Level 4 qualifications or above"]/100}})))});let o,u={Age:{low:.21826,high:.243619},Tenure:{low:.199771+.168034,high:.630903},Class:{low:.232833+.327573,high:.213454+.22614},Education:{low:.147624,high:.274402}},c=d=>(o=a.filter(_=>_.PCON25CD==d)[0],o==null?0:s.reduce((_,m)=>_+m.swing*o[m.name].high/u[m.name].high-m.swing*o[m.name].low/u[m.name].low,0));function p(d){l=d,e(1,l)}function g(d,_){n.$$.not_equal(_.swing,d)&&(_.swing=d,e(2,s))}function v(d){h=d,e(3,h)}return n.$$.update=()=>{n.$$.dirty&71&&i&&a&&(console.log(a),e(0,i=i.map(d=>({...d,swing_perc:{...d.swing_perc,Con:d.perc.Con-l-c(d.PCON25CD),Lab:d.perc.Lab+l+c(d.PCON25CD)}}))),e(0,i=i.filter(d=>["England","Wales"].includes(d.country_name)).map(d=>({...d,winner:Object.keys(d.swing_perc).reduce((_,m)=>d.swing_perc[_]>d.swing_perc[m]?_:m)}))),["Con","Lab","LD","SNP","Green","PC","Oths"].forEach(d=>e(5,r[d]=i.filter(_=>_.winner==d).length,r))),n.$$.dirty&1&&console.log(i),n.$$.dirty&25&&h&&(e(4,f=i.filter(d=>d.PCON25CD==h.properties.PCON25CD)[0].swing_perc),e(4,f=Object.keys(f).map(d=>({party:d,perc:f[d]})).filter(d=>d.perc>0).sort((d,_)=>_.perc-d.perc))),n.$$.dirty&4&&console.log(s)},[i,l,s,h,f,r,a,p,g,v]}class yo extends jn{constructor(t){super(),xn(this,t,wo,vo,Bn,{})}}new yo({target:document.getElementById("app")});
